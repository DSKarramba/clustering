##clustering

Проект по кластеризации предпочтений жителей города по перемещению, выраженных
в виде множества точек отправления и прибытия на карте OpenStreetMap.

Для работы необходим python v2.7 / v3.x.
Для использования метрики route необходим OSRM Server API v5.0 / v4.7.

Для информации запустите скрипт `kmeans.py` с ключом `--help`:

    python3 kmeans.py --help

####Ссылки
- [kmeans.py](/kmeans.py): кластеризатор точек методом K-Means.
- [routelib.py](/routelib.py): класс метрики расстояний по городским дорогам.
- [github.io](http://vstu-cad-stuff.github.io/clustering): визуализации работы
  алгоритмов.

####Файлы
- [data/](/data/): 5 выборок данных для тестов. Точки типа 1 -- начальное
  распредение кластеров, типа 0 -- кластеризуемые точки.
    + Файл `full.txt` -- выборка из 12000 точек и 125 кластеров.
    + Файл `few.txt` -- часть выборки `full`, 500 точек и 20 кластеров.
    + Файл `common.txt` -- выборка из 180 точек и 10 кластеров, городской
      квартал.
    + Файл `river.txt` -- выборка из 6 точек и 2 кластеров, естественное
      препятствие - река.
    + Файл `railway.txt` -- выборка из 6 точек и 2 кластеров, искуственное
      препятствие - железная дорога.
- [ClusteringMachine.py](/ClusteringMachine.py): шаблон класса для
  кластеризации.
- [converter.py](/converter.py): конвертер итерационных логов алгоритма в
  формат js для визуализации. Для расчета выпуклых оболочек используется
  [Алгоритм Джарвиса](https://ru.wikipedia.org/wiki/Алгоритм_Джарвиса).
- [DataCollector.py](/DataCollector.py): класс для сбора данных.
- [InitMachine.py](/InitMachine.py): класс для загрузки начального
  распределения кластеров.
- [kmeans.py](/kmeans.py): скрипт кластеризации по заданным параметрам.
- [KMeansMachine.py](/KMeansMachine.py): класс, реализующий кластеризацию с
  помощью алгоритма K-Means.
- [KMeansMachineTriangle.py](/KMeansMachineTriangle.py): класс, реализующий
  кластеризацию с помощью алгоритма K-Means. Использовалась статья
  ["Using the Triangle Inequality to Accelerate k-Means" by Elkan
  Ch.](http://cseweb.ucsd.edu/~elkan/kmeansicml03.pdf) для сокращения
  количества вычислений дистанций (количество сокращается, однако из-за
  ненайденной ошибки происходит создание одного большого кластера,
  перекрывающего остальные ([look
  here](http://vstu-cad-stuff.github.io/clustering/with_triangle/))).
- [routelib.py](/routelib.py) -- класс метрики, основанный на вычислении
  дистанций между точками с использованием движка
  [OSRM](https://github.com/Project-OSRM/osrm-backend/).

####Примеры использования
Кластеризация данных всех типов из выборки `full` с евклидовой метрикой и
случайным начальным распределением 100 кластеров и ограничением по количеству
итераций в 50:

    python3 kmeans.py -p data/full.txt -m euclid -i random -r 100 -n 50

Кластеризация данных всех типов из файла `data.txt` с метрикой `route` (карта
подгружается из файла `~/map.osrm`) с начальными кластерами, распределенными
по сетке 3×4 без логгирования на итерациях и вывода в консоль:

    python3 kmeans.py -p data.txt --map ~/map.osrm -i grid -g 3 4 --nolog -q!

Кластеризация всех данных, кроме типа 1, из файла `data.txt` с расчетом
расстояний по поверхности; начальные кластеры являются данными типа 1 из файла
`data.txt`; распараллеливание расчетов на 8 потоков:

    python3 kmeans.py -p data.txt 1 -c data.txt 1 -m surface -t 8

----

Для очистки директории от временных файлов используются следующие команды:

1. `git clean -df` для удаления файлов, несопровождаемых Git
2. `git checkout -- .` для восстановления всех сопровождаемых файлов к последнему сделанному коммиту.
